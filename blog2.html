<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Blog 2 - Advanced Projects | Terraform Blog</title>
    <link rel="stylesheet" href="assets/css/style.css">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&family=Source+Code+Pro:wght@300;400;500&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-logo">
                <a href="index.html" style="text-decoration: none; color: inherit;">
                    <h2>Terraform<span class="logo-accent">Blog</span></h2>
                </a>
            </div>
            <ul class="nav-menu">
                <li class="nav-item">
                    <a href="index.html" class="nav-link">Home</a>
                </li>
                <li class="nav-item">
                    <a href="index.html#terraform-history" class="nav-link">History</a>
                </li>
                <li class="nav-item">
                    <a href="index.html#harshi-corp" class="nav-link">Harshi Corp</a>
                </li>
                <li class="nav-item">
                    <a href="blog1.html" class="nav-link nav-button">Blog 1</a>
                </li>
                <li class="nav-item">
                    <a href="blog2.html" class="nav-link nav-button">Blog 2</a>
                </li>
            </ul>
            <div class="hamburger">
                <span class="bar"></span>
                <span class="bar"></span>
                <span class="bar"></span>
            </div>
        </div>
    </nav>

    <!-- Blog 2 Header -->
    <section class="hero">
        <div class="container">
            <div class="hero-content" style="text-align: center; max-width: 800px; margin: 0 auto;">
                <h1 class="hero-title">Blog 2: <span class="terraform-gradient">Advanced Projects</span></h1>
                <p class="hero-subtitle">
                    Take your Terraform skills to the next level with remote backends, workspace management, 
                    and production-grade deployments across multiple cloud platforms.
                </p>
                <div class="hero-buttons" style="justify-content: center;">
                    <a href="#project1" class="btn btn-primary">Remote Backends</a>
                    <a href="#project2" class="btn btn-secondary">React App</a>
                    <a href="#project3" class="btn btn-outline">EpicBook</a>
                </div>
            </div>
        </div>
    </section>

    <!-- Project 1: Remote Backends -->
    <section id="project1" class="section-dark">
        <div class="container">
            <div class="section-header">
                <h2 class="section-title">Project 1: Remote Backends & State Locking</h2>
                <p class="section-subtitle">Secure state management with Azure and AWS backends</p>
            </div>

            <div class="project-content">
                <div class="project-overview">
                    <h3>Overview</h3>
                    <p>Implement secure remote state management with locking mechanisms to enable team collaboration and prevent state conflicts in production environments.</p>
                    
                    <div class="project-features">
                        <h4>Key Features</h4>
                        <ul class="feature-list">
                            <li>Azure Storage Account backend</li>
                            <li>AWS S3 + DynamoDB backend</li>
                            <li>State locking and consistency</li>
                            <li>Team collaboration ready</li>
                        </ul>
                    </div>
                </div>

                <div class="file-structure">
                    <h3>File Structure</h3>
                    <div class="code-window">
                        <div class="window-header">
                            <div class="window-controls">
                                <span class="control red"></span>
                                <span class="control yellow"></span>
                                <span class="control green"></span>
                            </div>
                            <span class="window-title">project-structure</span>
                        </div>
                        <div class="code-content">
                            <pre><code>remote-backends/
├── azure-backend/
│   ├── main.tf
│   ├── backend.tf
│   ├── providers.tf
│   └── variables.tf
├── aws-backend/
│   ├── main.tf
│   ├── backend.tf
│   ├── providers.tf
│   └── variables.tf
└── multi-backend-setup/
    ├── main.tf
    ├── backend.hcl
    └── README.md</code></pre>
                        </div>
                    </div>
                </div>

                <div class="code-samples">
                    <h3>Implementation Code</h3>
                    
                    <div class="code-sample">
                        <h4>Azure Backend Configuration</h4>
                        <div class="code-window">
                            <div class="window-header">
                                <div class="window-controls">
                                    <span class="control red"></span>
                                    <span class="control yellow"></span>
                                    <span class="control green"></span>
                                </div>
                                <span class="window-title">backend.tf</span>
                            </div>
                            <div class="code-content">
                                <pre><code>terraform {
  backend "azurerm" {
    resource_group_name  = "tfstate-rg"
    storage_account_name = "tfstatestorage123"
    container_name       = "tfstate"
    key                  = "prod.terraform.tfstate"
    subscription_id      = "00000000-0000-0000-0000-000000000000"
    
    # Optional: Use SAS token or Managed Identity
    # sas_token = "your-sas-token"
  }
}

# Create storage account for backend
resource "azurerm_storage_account" "tfstate" {
  name                     = "tfstatestorage123"
  resource_group_name      = azurerm_resource_group.tfstate.name
  location                 = azurerm_resource_group.tfstate.location
  account_tier             = "Standard"
  account_replication_type = "LRS"

  tags = {
    environment = "production"
    purpose     = "terraform-backend"
  }
}

resource "azurerm_storage_container" "tfstate" {
  name                  = "tfstate"
  storage_account_name  = azurerm_storage_account.tfstate.name
  container_access_type = "private"
}</code></pre>
                            </div>
                        </div>
                    </div>

                    <div class="code-sample">
                        <h4>AWS Backend Configuration</h4>
                        <div class="code-window">
                            <div class="window-header">
                                <div class="window-controls">
                                    <span class="control red"></span>
                                    <span class="control yellow"></span>
                                    <span class="control green"></span>
                                </div>
                                <span class="window-title">backend.tf</span>
                            </div>
                            <div class="code-content">
                                <pre><code>terraform {
  backend "s3" {
    bucket = "terraform-state-prod-2024"
    key    = "global/s3/terraform.tfstate"
    region = "us-east-1"

    # State locking with DynamoDB
    dynamodb_table = "terraform-state-locking"
    encrypt        = true

    # Optional: Assume Role for cross-account access
    # role_arn = "arn:aws:iam::ACCOUNT_ID:role/DeploymentRole"
  }
}

# S3 Bucket for State Storage
resource "aws_s3_bucket" "terraform_state" {
  bucket = "terraform-state-prod-2024"

  tags = {
    Name        = "Terraform State Storage"
    Environment = "Production"
  }
}

resource "aws_s3_bucket_versioning" "terraform_state" {
  bucket = aws_s3_bucket.terraform_state.id
  versioning_configuration {
    status = "Enabled"
  }
}

resource "aws_s3_bucket_server_side_encryption_configuration" "terraform_state" {
  bucket = aws_s3_bucket.terraform_state.id

  rule {
    apply_server_side_encryption_by_default {
      sse_algorithm = "AES256"
    }
  }
}

# DynamoDB for State Locking
resource "aws_dynamodb_table" "terraform_state_lock" {
  name           = "terraform-state-locking"
  billing_mode   = "PAY_PER_REQUEST"
  hash_key       = "LockID"

  attribute {
    name = "LockID"
    type = "S"
  }

  tags = {
    Name = "Terraform State Lock Table"
  }
}</code></pre>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Project 2: React App with Workspaces -->
    <section id="project2" class="section-light">
        <div class="container">
            <div class="section-header">
                <h2 class="section-title">Project 2: React App with Terraform Workspaces</h2>
                <p class="section-subtitle">Multi-environment deployment using Terraform workspaces</p>
            </div>

            <div class="project-content">
                <div class="project-overview">
                    <h3>Overview</h3>
                    <p>Deploy a React application to multiple environments (dev, staging, prod) using Terraform workspaces with isolated infrastructure and environment-specific configurations.</p>
                    
                    <div class="project-features">
                        <h4>Key Features</h4>
                        <ul class="feature-list">
                            <li>Environment isolation with workspaces</li>
                            <li>S3 + CloudFront deployment</li>
                            <li>Custom domain with Route53</li>
                            <li>SSL certificate automation</li>
                        </ul>
                    </div>
                </div>

                <div class="file-structure">
                    <h3>File Structure</h3>
                    <div class="code-window">
                        <div class="window-header">
                            <div class="window-controls">
                                <span class="control red"></span>
                                <span class="control yellow"></span>
                                <span class="control green"></span>
                            </div>
                            <span class="window-title">project-structure</span>
                        </div>
                        <div class="code-content">
                            <pre><code>react-app-workspaces/
├── environments/
│   ├── dev/
│   │   ├── main.tf
│   │   └── variables.tf
│   ├── staging/
│   │   ├── main.tf
│   │   └── variables.tf
│   └── prod/
│       ├── main.tf
│       └── variables.tf
├── modules/
│   ├── s3-cloudfront/
│   │   ├── main.tf
│   │   └── variables.tf
│   ├── route53/
│   │   ├── main.tf
│   │   └── variables.tf
│   └── acm/
│       ├── main.tf
│       └── variables.tf
├── main.tf
├── variables.tf
├── workspace-variables.tfvars
└── build-script.sh</code></pre>
                        </div>
                    </div>
                </div>

                <div class="code-samples">
                    <h3>Implementation Code</h3>
                    
                    <div class="code-sample">
                        <h4>Workspace Configuration</h4>
                        <div class="code-window">
                            <div class="window-header">
                                <div class="window-controls">
                                    <span class="control red"></span>
                                    <span class="control yellow"></span>
                                    <span class="control green"></span>
                                </div>
                                <span class="window-title">main.tf</span>
                            </div>
                            <div class="code-content">
                                <pre><code># Workspace-specific variables
locals {
  environment = terraform.workspace
  
  common_tags = {
    Project     = "react-app"
    Environment = local.environment
    ManagedBy   = "terraform"
  }

  # Environment-specific configuration
  config = {
    dev = {
      instance_type = "t2.micro"
      min_size      = 1
      max_size      = 2
      domain_name   = "dev.myapp.com"
    }
    staging = {
      instance_type = "t2.small"
      min_size      = 2
      max_size      = 4
      domain_name   = "staging.myapp.com"
    }
    prod = {
      instance_type = "t2.medium"
      min_size      = 2
      max_size      = 6
      domain_name   = "myapp.com"
    }
  }

  workspace_config = local.config[local.environment]
}

# S3 Module for Static Website
module "s3_cloudfront" {
  source = "./modules/s3-cloudfront"

  environment    = local.environment
  domain_name    = local.workspace_config.domain_name
  bucket_name    = "react-app-${local.environment}-${random_id.bucket_suffix.hex}"
  enable_versioning = local.environment == "prod" ? true : false

  tags = local.common_tags
}

# Route53 Module for DNS
module "route53" {
  source = "./modules/route53"

  domain_name = local.workspace_config.domain_name
  environment = local.environment
  cloudfront_distribution_id = module.s3_cloudfront.cloudfront_id

  tags = local.common_tags
}

# ACM Module for SSL Certificate
module "acm" {
  source = "./modules/acm"

  domain_name = local.workspace_config.domain_name
  environment = local.environment

  tags = local.common_tags
}

# Random suffix for bucket names
resource "random_id" "bucket_suffix" {
  byte_length = 4
}</code></pre>
                            </div>
                        </div>
                    </div>

                    <div class="code-sample">
                        <h4>Deployment Script</h4>
                        <div class="code-window">
                            <div class="window-header">
                                <div class="window-controls">
                                    <span class="control red"></span>
                                    <span class="control yellow"></span>
                                    <span class="control green"></span>
                                </div>
                                <span class="window-title">deploy.sh</span>
                            </div>
                            <div class="code-content">
                                <pre><code>#!/bin/bash

set -e

# Colors for output
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
NC='\033[0m'

# Function to print colored output
print_status() {
    echo -e "${GREEN}[INFO]${NC} $1"
}

print_warning() {
    echo -e "${YELLOW}[WARN]${NC} $1"
}

print_error() {
    echo -e "${RED}[ERROR]${NC} $1"
}

# Validate environment
ENVIRONMENT=${1:-dev}
VALID_ENVIRONMENTS=("dev" "staging" "prod")

if [[ ! " ${VALID_ENVIRONMENTS[@]} " =~ " ${ENVIRONMENT} " ]]; then
    print_error "Invalid environment: $ENVIRONMENT"
    echo "Usage: $0 [dev|staging|prod]"
    exit 1
fi

print_status "Deploying to $ENVIRONMENT environment"

# Build React app
print_status "Building React application..."
npm run build

# Initialize Terraform
print_status "Initializing Terraform..."
terraform init

# Select or create workspace
print_status "Setting Terraform workspace..."
terraform workspace select $ENVIRONMENT || terraform workspace new $ENVIRONMENT

# Plan deployment
print_status "Planning deployment..."
terraform plan -var-file="workspace-variables.tfvars" -var="environment=$ENVIRONMENT"

# Confirm deployment
read -p "Do you want to apply these changes? (y/n): " -n 1 -r
echo
if [[ $REPLY =~ ^[Yy]$ ]]; then
    # Apply changes
    print_status "Applying Terraform configuration..."
    terraform apply -var-file="workspace-variables.tfvars" -var="environment=$ENVIRONMENT"
    
    print_status "Deployment to $ENVIRONMENT completed successfully!"
else
    print_warning "Deployment cancelled"
    exit 0
fi</code></pre>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Navigation Buttons -->
    <section class="blog-navigation">
        <div class="container">
            <div class="navigation-buttons" style="text-align: center; padding: 3rem 0;">
                <a href="blog1.html" class="btn btn-primary">Back to Blog 1</a>
                <a href="index.html" class="btn btn-secondary">Back to Home</a>
            </div>
        </div>
    </section>

    <script src="assets/js/script.js"></script>
</body>
</html>